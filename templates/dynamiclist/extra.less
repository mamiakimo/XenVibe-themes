// ================================================
// DYNAMICLIST STYLE - Complete Implementation
// ================================================
// Based on Stitch DynamicList design
// Colors configured via update_style_colors.php (Style ID: 22)
// ================================================

// ================================================
// VARIABLES
// ================================================
@dl-max-width: 1600px;
@dl-content-padding: 1.5rem;
@dl-content-padding-lg: 10rem;

// Radius (from Tailwind config)
@dl-radius: 0.25rem;
@dl-radius-lg: 0.5rem;
@dl-radius-xl: 0.75rem;
@dl-radius-2xl: 1rem;

// ================================================
// FONT - Plus Jakarta Sans
// ================================================
@import (css) url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap');
@import (css) url('https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200');

// ================================================
// BASE STYLES
// ================================================
html.dl-style {
	scroll-behavior: smooth;
}

.dl-body {
	font-family: 'Plus Jakarta Sans', system-ui, -apple-system, sans-serif;
	background: @xf-pageBg;
	color: @xf-textColor;
	min-height: 100vh;
	display: flex;
	flex-direction: column;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}

.dl-page {
	display: flex;
	flex-direction: column;
	min-height: 100vh;
}

// ================================================
// SCROLLBAR STYLING
// ================================================
::-webkit-scrollbar {
	width: 8px;
	height: 8px;
}

::-webkit-scrollbar-track {
	background: @xf-pageBg;
}

::-webkit-scrollbar-thumb {
	background: @xf-borderColor;
	border-radius: 4px;

	&:hover {
		background: lighten(@xf-borderColor, 10%);
	}
}

// ================================================
// MATERIAL SYMBOLS
// ================================================
.material-symbols-outlined {
	font-variation-settings:
		'FILL' 0,
		'wght' 400,
		'GRAD' 0,
		'opsz' 24;
}

// ================================================
// HEADER - Sticky with blur effect
// ================================================
.dl-header {
	position: sticky;
	top: 0;
	z-index: 100;
	width: 100%;
	border-bottom: 1px solid @xf-borderColor;
	background: fade(@xf-pageBg, 95%);
	backdrop-filter: blur(12px);
	-webkit-backdrop-filter: blur(12px);

	@supports (backdrop-filter: blur(12px)) {
		background: fade(@xf-pageBg, 60%);
	}
}

.dl-header-inner {
	max-width: @dl-max-width;
	margin: 0 auto;
	padding: 0 @dl-content-padding;
	height: 64px;
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: 1rem;

	@media (min-width: 1024px) {
		padding: 0 @dl-content-padding-lg;
	}
}

.dl-header-start {
	display: flex;
	align-items: center;
	gap: 2rem;
}

.dl-header-end {
	display: flex;
	align-items: center;
	gap: 1rem;
}

// ================================================
// LOGO
// ================================================
.dl-logo {
	display: flex;
	align-items: center;
	gap: 0.75rem;
	text-decoration: none;

	img {
		max-height: 32px;
		width: auto;
	}
}

.dl-logo-icon {
	width: 32px;
	height: 32px;
	border-radius: @dl-radius-lg;
	background: @xf-linkColor;
	display: flex;
	align-items: center;
	justify-content: center;
	color: #fff;

	.material-symbols-outlined {
		font-size: 20px;
	}
}

.dl-logo-text {
	font-size: 1.125rem;
	font-weight: 700;
	color: @xf-textColor;
}

// ================================================
// NAVIGATION
// ================================================
.dl-nav {
	display: none;

	@media (min-width: 768px) {
		display: flex;
		align-items: center;
		gap: 1.5rem;
	}
}

.dl-nav-item {
	position: relative;
}

.dl-nav-link {
	font-size: 0.875rem;
	font-weight: 500;
	color: @xf-textColorMuted;
	text-decoration: none;
	padding: 0.5rem 0;
	transition: color 0.2s ease;

	&:hover {
		color: @xf-textColor;
	}

	&.is-active {
		color: @xf-textColor;
		font-weight: 600;
		border-bottom: 2px solid @xf-linkColor;
	}
}

// ================================================
// SEARCH
// ================================================
.dl-search {
	display: none;

	@media (min-width: 1024px) {
		display: block;
	}
}

.dl-search-trigger {
	display: flex;
	align-items: center;
	gap: 0.5rem;
	padding: 0.5rem 1rem;
	background: @xf-contentBg;
	border: 1px solid @xf-borderColor;
	border-radius: @dl-radius-lg;
	color: @xf-textColorMuted;
	text-decoration: none;
	min-width: 160px;
	transition: all 0.2s ease;

	&:hover {
		border-color: @xf-linkColor;
	}

	@media (min-width: 1024px) {
		min-width: 256px;
	}

	.material-symbols-outlined {
		font-size: 20px;
	}
}

.dl-search-text {
	font-size: 0.875rem;
}

// ================================================
// HEADER ICONS
// ================================================
.dl-icon-btn {
	position: relative;
	padding: 0.5rem;
	color: @xf-textColorMuted;
	border-radius: @dl-radius-lg;
	transition: all 0.2s ease;
	background: transparent;
	border: none;
	cursor: pointer;

	&:hover {
		background: @xf-contentBg;
		color: @xf-textColor;
	}

	.material-symbols-outlined {
		font-size: 24px;
	}
}

.dl-badge {
	position: absolute;
	top: 4px;
	inset-inline-end: 4px;
	width: 8px;
	height: 8px;
	background: #ef4444;
	border-radius: 50%;
	border: 2px solid @xf-pageBg;
}

.dl-avatar-wrap {
	cursor: pointer;

	.avatar {
		width: 36px;
		height: 36px;
		border-radius: 50%;
		border: 2px solid @xf-borderColor;
		transition: border-color 0.2s ease;

		&:hover {
			border-color: @xf-linkColor;
		}
	}
}

// ================================================
// BUTTONS
// ================================================
.dl-btn-primary {
	display: inline-flex;
	align-items: center;
	gap: 0.5rem;
	padding: 0.625rem 1.25rem;
	background: @xf-linkColor;
	color: #fff;
	font-size: 0.875rem;
	font-weight: 700;
	border-radius: @dl-radius-lg;
	text-decoration: none;
	border: none;
	cursor: pointer;
	transition: all 0.2s ease;
	box-shadow: 0 4px 12px fade(@xf-linkColor, 20%);

	&:hover {
		background: darken(@xf-linkColor, 8%);
		color: #fff;
		transform: translateY(-1px);
	}

	.material-symbols-outlined {
		font-size: 20px;
	}
}

.dl-btn-text {
	padding: 0.5rem 1rem;
	color: @xf-textColor;
	font-weight: 500;
	font-size: 0.875rem;
	text-decoration: none;
	transition: color 0.2s ease;

	&:hover {
		color: @xf-linkColor;
	}
}

// ================================================
// MAIN CONTENT AREA
// ================================================
.dl-main {
	flex-grow: 1;
	width: 100%;
	max-width: @dl-max-width;
	margin: 0 auto;
	padding: 1.5rem @dl-content-padding 2rem;

	@media (min-width: 1024px) {
		padding: 2rem @dl-content-padding-lg;
	}
}

.dl-notices {
	max-width: @dl-max-width;
	margin: 0 auto;
	padding: 0 @dl-content-padding;

	@media (min-width: 1024px) {
		padding: 0 @dl-content-padding-lg;
	}
}

.dl-block-notices {
	margin-bottom: 1.5rem;
}

// ================================================
// BREADCRUMBS
// ================================================
.dl-breadcrumb {
	display: flex;
	flex-wrap: wrap;
	align-items: center;
	gap: 0.5rem;
	margin-bottom: 1rem;
	font-size: 0.875rem;

	a {
		color: @xf-textColorMuted;
		text-decoration: none;
		transition: color 0.2s ease;

		&:hover {
			color: @xf-linkColor;
		}
	}

	&--bottom {
		margin-top: 2rem;
		margin-bottom: 0;
	}
}

.dl-breadcrumb-sep {
	color: @xf-textColorMuted;
	opacity: 0.5;
}

// ================================================
// PAGE HEADER
// ================================================
.dl-page-header {
	display: flex;
	flex-direction: column;
	gap: 1rem;
	margin-bottom: 1.5rem;

	@media (min-width: 768px) {
		flex-direction: row;
		align-items: flex-end;
		justify-content: space-between;
	}
}

.dl-page-header-content {
	flex: 1;
}

.dl-page-title {
	font-size: 1.875rem;
	font-weight: 700;
	color: @xf-textColor;
	line-height: 1.25;
	margin: 0 0 0.5rem 0;
}

.dl-page-desc {
	font-size: 1rem;
	color: @xf-textColorMuted;
	margin: 0;
	line-height: 1.5;
}

.dl-page-actions {
	flex-shrink: 0;
}

// ================================================
// LAYOUT - 4-Column Grid (3 main + 1 sidebar)
// ================================================
.dl-layout {
	display: grid;
	grid-template-columns: 1fr;
	gap: 1.5rem;

	@media (min-width: 1024px) {
		grid-template-columns: 1fr 280px;
	}
}

.dl-layout-main {
	min-width: 0;
}

// ================================================
// SIDEBAR
// ================================================
.dl-sidebar {
	display: none;

	@media (min-width: 1024px) {
		display: block;
	}

	.block {
		background: @xf-contentBg;
		border: 1px solid @xf-borderColor;
		border-radius: @dl-radius-xl;
		overflow: hidden;
		margin-bottom: 1.5rem;

		.block-container {
			background: transparent;
			border: none;
		}

		.block-header,
		.block-minorHeader {
			display: flex;
			align-items: center;
			gap: 0.5rem;
			padding: 1rem 1.25rem;
			background: transparent;
			border-bottom: none;
			font-size: 1rem;
			font-weight: 700;
			color: @xf-textColor;
			text-transform: none;

			&::before {
				font-family: 'Material Symbols Outlined';
				font-size: 20px;
				color: @xf-linkColor;
				font-weight: normal;
			}
		}

		.block-body {
			padding: 0 1.25rem 1.25rem;
		}

		// If header exists, reduce gap
		.block-header + .block-body,
		.block-minorHeader + .block-body {
			padding-top: 0;
		}
	}
}

// Widget icon mapping
[data-widget-key="forum_overview_forum_statistics"] .block-minorHeader::before {
	content: 'equalizer';
}

[data-widget-key="forum_overview_members_online"] .block-minorHeader::before {
	content: 'badge';
}

[data-widget-key="forum_overview_new_posts"] .block-minorHeader::before {
	content: 'history';
}

// ================================================
// SIDEBAR STATS GRID
// ================================================
.dl-sidebar .pairs {
	display: flex;
	justify-content: space-between;
	align-items: baseline;
	padding: 0.5rem 0;
	border-bottom: 1px solid fade(@xf-borderColor, 50%);

	&:last-child {
		border-bottom: none;
	}

	dt {
		font-size: 0.75rem;
		color: @xf-textColorMuted;
	}

	dd {
		font-size: 0.875rem;
		font-weight: 600;
		color: @xf-textColor;
		margin: 0;
	}
}

// ================================================
// SIDEBAR AVATAR LIST
// ================================================
.dl-sidebar .listHeap {
	display: flex;
	flex-wrap: wrap;
	gap: 0.5rem;
	list-style: none;
	padding: 0;
	margin: 0;

	li {
		margin: 0;
	}

	.avatar {
		width: 32px;
		height: 32px;
		border-radius: @dl-radius;
		border: 1px solid @xf-borderColor;
	}
}

// ================================================
// FOOTER
// ================================================
.dl-footer {
	background: @xf-pageBg;
	border-top: 1px solid @xf-borderColor;
	padding: 2rem @dl-content-padding;
	margin-top: auto;

	@media (min-width: 1024px) {
		padding: 2rem @dl-content-padding-lg;
	}
}

.dl-footer-inner {
	max-width: @dl-max-width;
	margin: 0 auto;
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: 1rem;
	text-align: center;

	@media (min-width: 768px) {
		flex-direction: row;
		justify-content: space-between;
		text-align: start;
	}
}

.dl-footer-copy {
	font-size: 0.875rem;
	color: @xf-textColorMuted;
	margin: 0;
	display: flex;
	align-items: center;
	gap: 0.5rem;
	flex-wrap: wrap;
	justify-content: center;

	a {
		color: @xf-linkColor;
		text-decoration: none;

		&:hover {
			text-decoration: underline;
		}
	}
}

.dl-footer-divider {
	opacity: 0.5;
}

.dl-footer-choosers {
	display: flex;
	align-items: center;
	gap: 0.75rem;
}

.dl-footer-chooser {
	display: inline-flex;
	align-items: center;
	gap: 0.375rem;
	padding: 0.375rem 0.75rem;
	font-size: 0.8125rem;
	font-weight: 500;
	color: @xf-textColorMuted;
	background: @xf-contentBg;
	border: 1px solid @xf-borderColor;
	border-radius: @dl-radius-xl;
	text-decoration: none;
	transition: all 0.2s ease;

	&:hover {
		color: @xf-linkColor;
		border-color: @xf-linkColor;
		background: @xf-contentHighlightBg;
	}

	.material-symbols-outlined {
		font-size: 18px;
	}
}

.dl-footer-links {
	display: flex;
	gap: 1.5rem;
	font-size: 0.875rem;
	font-weight: 500;

	a {
		color: @xf-textColorMuted;
		text-decoration: none;
		transition: color 0.2s ease;

		&:hover {
			color: @xf-linkColor;
		}
	}
}

// ================================================
// MOBILE FAB
// ================================================
.dl-fab {
	display: none;
	position: fixed;
	bottom: 1.5rem;
	inset-inline-start: 1.5rem;
	z-index: 40;
	width: 56px;
	height: 56px;
	background: @xf-linkColor;
	color: #fff;
	border-radius: 50%;
	align-items: center;
	justify-content: center;
	box-shadow: 0 4px 16px fade(@xf-linkColor, 40%);
	text-decoration: none;
	transition: transform 0.2s ease;
	border: none;
	cursor: pointer;

	@media (max-width: 768px) {
		display: flex;
	}

	&:hover {
		transform: scale(1.1);
	}

	.material-symbols-outlined {
		font-size: 28px;
	}
}

// ================================================
// XENFORO OVERRIDES
// ================================================
// Hide default XenForo elements
.p-nav,
.p-header,
.p-sectionLinks,
.p-footer {
	display: none !important;
}

.p-body {
	padding: 0 !important;
	max-width: none !important;
}

.p-body-inner {
	max-width: none !important;
	padding: 0 !important;
}

.p-body-main {
	padding: 0 !important;
}

body.dl-body {
	padding: 0 !important;
}

// ================================================
// FORUM LIST PAGE STYLING
// ================================================
.template-forum_list {

	// Remove main block styling in main content area (but NOT category blocks)
	.dl-layout-main {
		> .dl-content > .block:not(.block--category),
		> .dl-content .block-container:not(.block--category .block-container) {
			background: transparent !important;
			border: none !important;
			box-shadow: none !important;
		}

		> .dl-content > .block:not(.block--category) > .block-container > .block-body {
			background: transparent !important;
			padding: 0 !important;
		}
	}

	// Category container
	.block--category {
		background: @xf-contentBg !important; // Match sidebar widgets background
		border: 1px solid @xf-borderColor !important;
		border-radius: @dl-radius-xl !important;
		overflow: hidden !important;
		margin-bottom: 1.5rem !important;
		box-shadow: 0 1px 3px fade(#000, 5%) !important;

		.block-container {
			background: @xf-contentBg !important; // Match sidebar widgets background
			border: none !important;
			display: block !important;
		}

		.block-body {
			padding: 0 !important;
			background: @xf-contentBg !important; // Match sidebar widgets background
			display: block !important;
		}
	}

	// =============================================
	// CATEGORY HEADER - CRITICAL FIX
	// Must completely override XenForo defaults
	// =============================================
	.block--category > .block-container > .block-header,
	.block--category .block-header,
	.block-header {
		// Force block-level reset first
		display: flex !important;
		flex-direction: row !important;
		flex-wrap: nowrap !important;
		align-items: center !important;
		justify-content: space-between !important;

		// Sizing
		width: 100% !important;
		max-width: 100% !important;
		min-width: 100% !important;
		box-sizing: border-box !important;

		// Spacing
		padding: 0.75rem 1.25rem !important;
		margin: 0 !important;

		// Background - Stitch color @xf-contentHighlightBg
		background: @xf-contentHighlightBg !important;
		background-color: @xf-contentHighlightBg !important;
		border-bottom: 1px solid @xf-borderColor !important;

		// Kill any grid
		grid-template-columns: unset !important;
		grid-column: unset !important;

		// All children
		> * {
			grid-column: unset !important;
			max-width: none !important;
		}
	}

	// Category title text
	.block--category .block-header a,
	.block--category .block-header .block-header-title,
	.block-header a,
	.block-header .block-header-title {
		flex: 1 1 auto !important;
		display: inline-flex !important;
		align-items: center !important;
		gap: 0.5rem !important;

		// Text styling
		font-size: 1.125rem !important;
		font-weight: 700 !important;
		color: @xf-textColor !important;
		text-decoration: none !important;
		white-space: nowrap !important;

		// Allow expansion
		width: auto !important;
		max-width: none !important;
		min-width: 0 !important;

		// No grid constraints
		grid-column: unset !important;

		&:hover {
			color: @xf-linkColor !important;
		}

		// Category icon in header
		.dl-category-icon {
			color: @xf-linkColor !important;
			font-size: 20px !important;
		}
	}

	// Toggle button on right
	// Toggle button styling
	.block--category .block-header .block-header-toggle,
	.block-header .block-header-toggle {
		flex: 0 0 auto !important;
		margin-inline-start: auto !important;
		color: @xf-textColorMuted !important;
		grid-column: unset !important;
		cursor: pointer !important;
		padding: 0.25rem !important;
		border-radius: @dl-radius !important;
		transition: all 0.2s ease !important;
		display: flex !important;
		align-items: center !important;
		justify-content: center !important;
		// Reset button styles
		background: none !important;
		border: none !important;
		outline: none !important;

		&:hover {
			color: @xf-textColor !important;
			background: fade(@xf-pageBg, 50%) !important;
		}

		// Toggle icon
		.material-symbols-outlined,
		.dl-toggle-icon {
			font-size: 20px !important;
			transition: transform 0.2s ease !important;
		}
	}

	// Collapsed state - rotate toggle icon 180deg
	.block--collapsed .block-header-toggle .material-symbols-outlined,
	.block--collapsed .block-header-toggle .dl-toggle-icon,
	.is-collapsed .block-header-toggle .material-symbols-outlined,
	.is-collapsed .block-header-toggle .dl-toggle-icon {
		transform: rotate(180deg) !important;
	}

	// Hide body when collapsed (XenForo adds these classes)
	.block--collapsed .block-body,
	.is-collapsed .block-body {
		display: none !important;
	}

	// List header (column labels) - ONLY inside block-body
	.block--category .block-body .dl-list-header {
		display: none;
		grid-template-columns: repeat(12, 1fr);
		gap: 1rem;
		padding: 0.5rem 1.25rem;
		background: @xf-contentBg;
		border-bottom: 1px solid @xf-borderColor;
		font-size: 0.6875rem;
		font-weight: 600;
		color: @xf-textColorMuted;
		text-transform: uppercase;
		letter-spacing: 0.05em;

		@media (min-width: 768px) {
			display: grid;
		}
	}

	// Forum node (row) - ONLY .node elements, not block-header
	.node {
		position: relative;
		display: flex !important;
		flex-wrap: wrap !important;
		gap: 1rem !important;
		padding: 1rem 1.25rem !important;
		border-bottom: 1px solid @xf-borderColor;
		background: transparent !important;
		transition: background 0.2s ease;
		align-items: center !important;

		// Desktop: 3-column layout with fixed positions
		@media (min-width: 768px) {
			flex-wrap: nowrap !important;
			// Reserve right side space for stats + extra columns
			padding-inline-end: 1.25rem !important;
		}

		&:last-child {
			border-bottom: none;
		}

		&:hover {
			background: fade(@xf-contentHighlightBg, 50%);

			&::before {
				opacity: 1;
			}
		}

		// Left border indicator (RTL-aware)
		&::before {
			content: '';
			position: absolute;
			inset-inline-start: 0;
			top: 0;
			bottom: 0;
			width: 3px;
			background: @xf-linkColor;
			opacity: 0;
			transition: opacity 0.2s ease;
		}

		// Unread state
		&.node--unread::before {
			opacity: 1;
		}
	}

	// Node body (info column) - CRITICAL: Must expand
	.node-body {
		display: flex !important;
		align-items: flex-start !important;
		gap: 1rem !important;
		flex: 1 1 auto !important;
		min-width: 200px !important;
		width: auto !important;

		@media (min-width: 768px) {
			flex: 1 1 60% !important;
			min-width: 300px !important;
		}
	}

	// Forum icon
	.node-icon {
		flex-shrink: 0;
		position: relative;
		padding-top: 0.25rem;

		i, .fa, .fas, .far {
			font-size: 1.875rem;
			color: @xf-linkColor;
			transition: color 0.2s ease;
		}

		// Status indicator
		&::after {
			content: '';
			position: absolute;
			top: 0;
			inset-inline-end: 0;
			width: 10px;
			height: 10px;
			background: #22c55e;
			border: 2px solid @xf-contentBg;
			border-radius: 50%;
			display: none;
		}

		.node--unread &::after {
			display: block;
		}

		.node:not(.node--unread) & i,
		.node:not(.node--unread) & .fa {
			color: @xf-textColorMuted;
			opacity: 0.6;
		}
	}

	// Node main content - CRITICAL FIX for vertical text
	.node-main {
		flex: 1 1 auto !important;
		min-width: 200px !important;
		width: auto !important;
		max-width: none !important;
		display: flex !important;
		flex-direction: column !important;
		gap: 0.25rem !important;
	}

	// Forum title - CRITICAL FIX
	.node-title {
		font-size: 1rem !important;
		font-weight: 700 !important;
		color: @xf-textColor !important;
		line-height: 1.4 !important;
		margin: 0 !important;
		white-space: normal !important;
		word-wrap: break-word !important;
		overflow-wrap: break-word !important;
		min-width: 150px !important;
		width: auto !important;
		max-width: none !important;

		a {
			color: inherit !important;
			text-decoration: none !important;
			transition: color 0.2s ease;
			display: inline !important;
			white-space: normal !important;

			&:hover {
				color: @xf-linkColor !important;
			}
		}
	}

	// Forum description
	.node-description {
		font-size: 0.875rem;
		color: @xf-textColorMuted;
		line-height: 1.5;
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
		margin: 0;
	}

	// Sub-forums pills
	.node-subNodeList {
		display: flex;
		flex-wrap: wrap;
		gap: 0.5rem;
		margin-top: 0.25rem;
	}

	.node-subNodeLink {
		display: inline-flex;
		align-items: center;
		gap: 0.25rem;
		padding: 0.125rem 0.5rem;
		background: fade(@xf-contentHighlightBg, 80%);
		border-radius: @dl-radius;
		font-size: 0.75rem;
		color: @xf-textColorMuted;
		text-decoration: none;
		transition: all 0.2s ease;

		&:hover {
			color: @xf-textColor;
			background: fade(@xf-linkColor, 20%);
		}

		&::before {
			content: '';
			width: 6px;
			height: 6px;
			background: @xf-linkColor;
			border-radius: 50%;
		}

		&.node-subNodeLink--unread {
			color: @xf-textColor;
			font-weight: 500;
		}
	}

	// Node stats - RIGID COLUMN, FIXED POSITION
	// Stats stay in exact same position regardless of node-extra presence
	.node-stats {
		// RIGID DIMENSIONS - never shrinks or grows
		box-sizing: border-box !important;
		flex: 0 0 120px !important;
		min-width: 120px !important;
		max-width: 120px !important;
		width: 120px !important;

		// Push to end of row (RTL-aware: end = right in LTR, left in RTL)
		margin-inline-start: auto !important;

		// VERTICAL STACKING - threads on top, messages below
		display: flex !important;
		flex-direction: column !important;
		align-items: flex-start !important;  // Align to start (left in LTR, right in RTL)
		justify-content: center !important;

		// Spacing
		gap: 0.125rem !important;
		padding: 0 !important;
		font-size: 0.875rem;
		color: @xf-textColorMuted;

		// Mobile: horizontal layout
		@media (max-width: 767px) {
			flex-direction: row !important;
			flex: 0 0 auto !important;
			min-width: 0 !important;
			max-width: none !important;
			width: auto !important;
			margin-inline-start: 0 !important;
			gap: 1.5rem !important;
		}

		// Each stat row - number + label inline
		dl {
			display: flex !important;
			flex-direction: row !important;
			align-items: baseline !important;
			justify-content: flex-start !important;  // Align content to start
			gap: 0.375rem !important;
			margin: 0 !important;
			padding: 0 !important;
			width: 100% !important;
			white-space: nowrap !important;
		}

		// Number value
		dd {
			font-weight: 600 !important;
			font-size: 0.875rem !important;
			color: @xf-textColor !important;
			margin: 0 !important;
			padding: 0 !important;
			// Fixed width for numbers to prevent shifting
			min-width: 2rem !important;
			text-align: end !important;  // Numbers align right (RTL-aware)
		}

		// Label text
		dt {
			font-size: 0.625rem !important;
			font-weight: 500 !important;
			text-transform: uppercase !important;
			letter-spacing: 0.02em !important;
			opacity: 0.7;
			margin: 0 !important;
			padding: 0 !important;
		}
	}

	// Node extra (last post column) - CSS GRID LAYOUT
	// Layout: Avatar on left spanning 2 rows, Title on top-right, User+Date on bottom-right
	.node-extra {
		// Reset auto-margin from node-stats when this element exists
		margin-inline-start: 0 !important;

		// Use CSS Grid for 2-row layout
		display: grid !important;
		grid-template-columns: auto 1fr !important;
		grid-template-rows: auto auto !important;
		gap: 0.25rem 0.75rem !important;
		align-items: center !important;

		padding: 0.5rem;
		background: fade(@xf-pageBg, 50%);
		border-radius: @dl-radius-lg;

		@media (min-width: 768px) {
			flex: 0 0 220px !important;
			min-width: 220px !important;
			max-width: 220px !important;
			background: transparent;
			padding: 0;
		}
	}

	// When node-extra exists, node-stats should not push itself
	.node-stats + .node-extra {
		margin-inline-start: 1rem !important;
	}

	.node-stats:last-child {
		// Stats is last child (no node-extra) - keep auto margin
		margin-inline-start: auto !important;
	}

	// Avatar - spans both rows (left column)
	.node-extra-icon {
		grid-column: 1 !important;
		grid-row: 1 / 3 !important;  // Span row 1 and 2
		align-self: start !important;
		padding-top: 0.125rem;

		.avatar {
			width: 36px;
			height: 36px;
			border-radius: 50%;
			background-size: cover;
			background-position: center;
		}
	}

	// First .node-extra-row (title) - row 1, column 2
	.node-extra-row {
		grid-column: 2 !important;
		grid-row: 1 !important;
		min-width: 0 !important;
		display: flex !important;
		flex-direction: row !important;
		flex-wrap: wrap !important;
		align-items: center !important;
		gap: 0.25rem !important;
	}

	// Second .node-extra-row (username/date) - row 2, column 2
	// Uses nth-child(3) because: child 1 = icon, child 2 = first row, child 3 = second row
	.node-extra-row:nth-child(3) {
		grid-column: 2 !important;
		grid-row: 2 !important;
		display: flex !important;
		flex-direction: row !important;
		align-items: center !important;
		gap: 0.25rem !important;
		font-size: 0.75rem;
		color: @xf-textColorMuted;
	}

	// Title styling (inside first .node-extra-row)
	.node-extra-title {
		flex: 1 1 auto !important;
		min-width: 0 !important;
		font-size: 0.875rem;
		font-weight: 500;
		color: @xf-textColor;
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
		line-height: 1.4 !important;

		a {
			color: inherit;
			text-decoration: none;

			&:hover {
				text-decoration: underline;
				color: @xf-linkColor;
			}
		}
	}

	// User styling (inside second .node-extra-row)
	.node-extra-user {
		display: inline !important;
		font-size: 0.75rem;
		color: @xf-textColorMuted;

		a {
			color: inherit;
			text-decoration: none;

			&:hover {
				color: @xf-textColor;
			}
		}

		// Separator dot after username
		&::after {
			content: 'Â·';
			margin-inline-start: 0.375rem;
			margin-inline-end: 0.125rem;
			color: @xf-textColorMuted;
			opacity: 0.6;
		}
	}

	// Date styling (inside second .node-extra-row)
	.node-extra-date {
		display: inline !important;
		font-size: 0.75rem;
		color: @xf-textColorMuted;

		a, time {
			color: inherit;
			text-decoration: none;

			&:hover {
				color: @xf-textColor;
			}
		}
	}

	// Hide default separators
	.block-outer,
	.block-outer-opposite {
		display: none;
	}
}

// ================================================
// PRIMARY BUTTONS STYLING
// ================================================
.button--primary,
.button.button--primary,
.button--cta {
	background: @xf-linkColor !important;
	border-color: @xf-linkColor !important;
	color: #fff !important;
	border-radius: @dl-radius-lg;
	font-weight: 600;
	transition: all 0.2s ease;
	box-shadow: 0 4px 12px fade(@xf-linkColor, 20%);

	&:hover {
		background: darken(@xf-linkColor, 8%) !important;
		border-color: darken(@xf-linkColor, 8%) !important;
		color: #fff !important;
		transform: translateY(-1px);
	}
}

// ================================================
// RESPONSIVE
// ================================================
@media (max-width: 767px) {
	.dl-header-inner {
		padding: 0 1rem;
		height: 56px;
	}

	.dl-main {
		padding: 1.5rem 1rem;
	}

	.dl-page-title {
		font-size: 1.5rem;
	}

	.template-forum_list {
		.node {
			padding: 1rem;
		}

		.node-body {
			gap: 0.75rem;
		}

		.node-icon i,
		.node-icon .fa {
			font-size: 1.5rem;
		}

		.node-title {
			font-size: 0.9375rem;
		}
	}
}

// ================================================
// RTL SUPPORT
// ================================================
[dir="rtl"] {
	.node::before {
		left: auto;
		right: 0;
	}

	.node-subNodeLink::before {
		margin-left: 0.25rem;
		margin-right: 0;
	}
}
